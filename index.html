<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Community Manager</title>
  <link rel="stylesheet" href="system.css">
  <link rel="stylesheet" href="style.css">
  <style>
    body {
      background-color: #404040;
      /* Desktop background */
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      overflow: hidden;
    }

    .app-window {
      width: 95%;
      max-width: 1600px;
      height: 90vh;
      margin: 0;
      display: flex;
      flex-direction: column;
      box-shadow: 1px 1px 0 #000;
    }

    .window-body {
      display: flex;
      flex: 1;
      overflow: hidden;
      padding: 0 !important;
      /* Override system.css padding */
    }

    .sidebar-column {
      width: 200px;
      border-right: 1px solid #000;
      padding: 10px;
      background: #fff;
    }

    .content-column {
      flex: 1;
      background: #fff;
      overflow-y: auto;
      padding: 20px;
      position: relative;
    }

    .tab-btn {
      min-width: 80px;
    }

    .tab-btn.active,
    .sidebar-btn.active {
      background: #000;
      color: #fff;
    }

    /* Correction for textareas */
    textarea {
      font-family: 'Chicago_12', 'Chicago', sans-serif;
      font-size: 16px;
      width: 100%;
      border: 1.5px solid #000;
      padding: 5px;
    }
  </style>
</head>

<body>

  <div class="window app-window">
    <div class="title-bar">
      <h1 class="title">OTTOmatic Community Manager</h1>
    </div>
    <div class="separator"></div>

    <div class="window-pane window-body">

      <!-- SIDEBAR -->
      <div class="sidebar-column">
        <!-- Logo -->
        <div style="margin-bottom: 20px; padding-top: 20px; text-align: center;">
          <img src="logo.png" alt="OTTO Logo" style="width: 50%; height: auto; image-rendering: pixelated;">
        </div>

        <ul class="sidebar-menu" role="menu-bar"
          style="flex-direction: column; width: 100%; box-shadow: none; border: none; padding: 0;">
          <li role="menu-item" style="padding: 0; margin-bottom: 10px;">
            <button class="btn sidebar-btn active" data-screen="nouveau-post"
              style="width: 100%; text-align: left;">Nouveau post</button>
          </li>
          <li role="menu-item" style="padding: 0; margin-bottom: 10px;">
            <button class="btn sidebar-btn" data-screen="file" style="width: 100%; text-align: left;">File
              d'attente</button>
          </li>
          <li role="menu-item" style="padding: 0; margin-bottom: 10px;">
            <button class="btn sidebar-btn" data-screen="parametres"
              style="width: 100%; text-align: left;">Paramètres</button>
          </li>
        </ul>

        <div style="margin-top: auto; padding-top: 20px; text-align: center;">
          <p style="font-size: 10px;">v1.0.0 (1984)</p>
        </div>
      </div>

      <!-- MAIN CONTENT -->
      <div class="content-column main-content">

        <!-- ================= ECRAN 1: NOUVEAU POST ================= -->
        <section id="nouveau-post" class="screen active">
          <fieldset
            style="margin-bottom: 0; padding-bottom: 0; border: 1px solid #000; background: transparent; color: #000;">
            <legend style="padding: 0 5px;">Workflow</legend>
            <div class="tabs" style="display: flex; gap: 5px; margin-bottom: 0; padding: 0 5px;">
              <button class="btn tab tab-btn active" data-tab="image">1. Image</button>
              <button class="btn tab tab-btn" data-tab="texte">2. Texte</button>
              <button class="btn tab tab-btn" data-tab="publication">3. Publier</button>
            </div>
          </fieldset>

          <!-- TAB IMAGE -->
          <div id="tab-image" class="tab-content active">
            <div class="field-row" style="margin-bottom: 10px;">
              <label for="image-input">Fichier source:</label>
              <div class="file-input-wrapper">
                <!-- Button moved inside preview -->
                <input type="file" id="image-input" accept="image/*"
                  style="opacity: 0; position: absolute; left: -9999px;">
              </div>
              <div id="image-status"></div>
            </div>

            <!-- Previews -->
            <div id="image-preview" class="image-preview empty"
              style="border: 2px dashed #000; height: 300px; display: flex; align-items: center; justify-content: center; background: #eee; margin-top: 10px;">
              <button class="btn" id="select-image-btn" style="padding: 10px 20px; font-size: 14px;">Choisir le
                fichier...</button>
            </div>

            <div id="image-controls" class="image-controls hidden" style="margin-top: 10px;">
              <div class="field-row" style="justify-content: center;">
                <canvas id="image-canvas" style="border: 1px solid #000; box-shadow: 1px 1px 0px #000;"></canvas>
              </div>

              <fieldset style="margin-top: 20px;">
                <legend>Réglages Image</legend>
                <div class="field-row" style="width: 100%;">
                  <label for="brightness" style="width: 80px;">Lumière:</label>
                  <input id="brightness" type="range" min="-100" max="100" value="0" style="flex: 1;">
                  <label id="brightness-value" style="width: 30px;">0</label>
                </div>
                <div class="field-row" style="width: 100%;">
                  <label for="contrast" style="width: 80px;">Contraste:</label>
                  <input id="contrast" type="range" min="-100" max="100" value="0" style="flex: 1;">
                  <label id="contrast-value" style="width: 30px;">0</label>
                </div>
                <!-- Reset Button -->
                <div class="field-row" style="width: 100%; justify-content: flex-end; margin-top: 5px;">
                  <button id="reset-image-btn" class="btn">Réinitialiser</button>
                </div>
              </fieldset>
            </div>

            <div class="field-row" style="margin-top: 20px; justify-content: flex-end;">
              <button class="btn btn-default" id="image-next-btn" disabled>Continuer ></button>
            </div>
          </div>

          <!-- TAB TEXTE -->
          <div id="tab-texte" class="tab-content">
            <div class="field-row-stacked" style="margin-bottom: 20px;">
              <label for="tone-of-voice">Style / Ton de voix:</label>
              <textarea id="tone-of-voice" rows="3" placeholder="Ex: Authentique, artisanal..."
                style="width: 100%; box-sizing: border-box;"></textarea>
            </div>

            <div class="field-row">
              <button class="btn" id="generate-text-btn">Générer des propositions</button>
            </div>

            <div id="text-proposals" class="text-proposals hidden" style="margin-top: 20px;">
            </div>

            <div id="text-edit" class="hidden" style="margin-top: 20px;">
              <label for="final-text">Texte final:</label>
              <textarea id="final-text" rows="6" style="width: 100%; box-sizing: border-box;"></textarea>
            </div>

            <div class="field-row" style="margin-top: 20px; justify-content: space-between;">
              <button class="btn" id="text-back-btn">
                < Retour</button>
                  <button class="btn btn-default" id="text-next-btn" disabled>Continuer ></button>
            </div>
          </div>

          <!-- TAB PUBLICATION -->
          <div id="tab-publication" class="tab-content">
            <fieldset>
              <legend>Options de publication</legend>
              <div class="field-row">
                <input type="radio" id="opt-now" name="pub-option" value="now">
                <label for="opt-now">Publier maintenant</label>
              </div>
              <div class="field-row">
                <input type="radio" id="opt-queue" name="pub-option" value="queue" checked>
                <label for="opt-queue">Ajouter à la file d'attente</label>
              </div>
              <div class="field-row">
                <input type="radio" id="opt-schedule" name="pub-option" value="schedule">
                <label for="opt-schedule">Planifier</label>
              </div>
            </fieldset>

            <div id="schedule-options" class="hidden" style="margin-top: 20px; padding-left: 20px;">
              <div class="field-row">
                <label for="schedule-datetime">Date:</label>
                <input type="datetime-local" id="schedule-datetime">
              </div>
            </div>

            <div class="field-row" style="margin-top: 30px; justify-content: space-between;">
              <button class="btn" id="pub-back-btn">
                < Retour</button>
                  <button class="btn btn-default" id="publish-btn">Terminer</button>
            </div>
          </div>
        </section>


        <!-- ================= ECRAN 2: FILE ================= -->
        <section id="file" class="screen">
          <h2 style="margin-bottom: 20px;">File d'attente</h2>

          <div id="post-list" class="post-list" style="display: flex; flex-direction: column; gap: 10px;">
            <!-- Posts here -->
          </div>

          <div id="empty-queue" class="empty-state" style="text-align: center; padding: 40px; border: 1px dotted #000;">
            <p>La file est vide.</p>
          </div>
        </section>


        <!-- ================= ECRAN 3: PARAMETRES ================= -->
        <section id="parametres" class="screen">
          <h2 style="margin-bottom: 20px;">Paramètres</h2>

          <fieldset>
            <legend>Compte Instagram</legend>
            <div class="field-row">
              <label for="instagram-account" style="width: 120px;">Nom d'utilisateur:</label>
              <input type="text" id="instagram-account" style="width: 200px;">
            </div>
            <div class="field-row" style="margin-top: 10px;">
              <button class="btn" id="connect-instagram-btn">Tester la connexion</button>
            </div>
          </fieldset>

          <fieldset style="margin-top: 20px;">
            <legend>Automatisation</legend>
            <div class="field-row">
              <label for="frequency" style="width: 120px;">Fréquence:</label>
              <select id="frequency">
                <option value="daily">Quotidien</option>
                <option value="weekly">Hebdomadaire</option>
              </select>
            </div>
            <div class="field-row">
              <label style="width: 120px;">Plage horaire:</label>
              <input type="time" id="time-start" value="09:00">
              <label>à</label>
              <input type="time" id="time-end" value="18:00">
            </div>
            <div class="field-row-stacked" style="margin-top: 10px;">
              <label for="default-tone">Ton par défaut / Instructions système:</label>
              <textarea id="default-tone" rows="6" placeholder="Ex: Ton amical, tutoiement, hashtags..."
                style="width: 100%; box-sizing: border-box; margin-top: 5px;"></textarea>
            </div>
          </fieldset>

          <fieldset style="margin-top: 20px;">
            <legend>Configuration IA (ChatGPT)</legend>
            <div class="field-row">
              <label for="openai-key" style="width: 120px;">Clé API OpenAI:</label>
              <input type="password" id="openai-key" style="width: 250px;" placeholder="sk-...">
            </div>
            <div class="field-row" style="margin-top: 5px;">
              <small style="color: #666; font-style: italic;">Nécessaire pour l'analyse d'image (Vision).</small>
            </div>
          </fieldset>

          <fieldset style="margin-top: 20px;">
            <legend>Automatisation (Webhook)</legend>
            <div class="field-row">
              <label for="webhook-url" style="width: 120px;">URL Webhook:</label>
              <input type="text" id="webhook-url" style="width: 250px;" placeholder="https://hook.make.com/...">
            </div>
          </fieldset>

          <div class="field-row" style="margin-top: 30px; justify-content: flex-end;">
            <button class="btn btn-default" id="save-settings-btn">Sauvegarder</button>
          </div>

          <div class="field-row" style="margin-top: 30px; justify-content: flex-end;">
            <button class="btn" onclick="localStorage.clear(); location.reload();">Réinitialiser l'application
              (Debug)</button>
          </div>
        </section>

      </div> <!-- End Content Column -->
    </div> <!-- End Window Pane -->
  </div> <!-- End Window -->

  <div class="sidebar-menu" style="display:none;"></div>
  <!-- Hide original sidebar selector target to avoid js error if strict, but I updated classes -->

  <script src="app.js"></script>
</body>

</html>